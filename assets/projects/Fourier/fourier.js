const BLACK = "#141414";
const GRAY = "#A4A4A4";
const GREEN = "#14F714";

const CIRCLE_COLOR = BLACK;
const PATH_COLOR = GRAY;
const POINTS_COLOR = GREEN;
const NUM_SAMPLES = 1000;

const canvas = document.getElementById("myCanvas");
const canvasDiv = document.getElementById("canvas");
var ctx = canvas.getContext("2d");	
canvas.focus();

canvas.width = canvasDiv.clientWidth;
canvas.height = canvasDiv.clientHeight;

var width = canvasDiv.clientWidth;
var height = canvasDiv.clientHeight;

var complex_scale = parseInt(document.getElementById("scale").value,10);
var num_circles = parseInt(document.getElementById("circles").value,10);
var drawpath = document.getElementById("drawpath").checked;
var drawpoints = document.getElementById("drawpoints").checked;
var drawcircles = document.getElementById("drawcircles").checked;

var origin = [Math.floor(width/2), Math.floor(height/2)];
var circles = [];
var points = [];
var lengths = [];
var output = [];
var loopFinished = false;
var t = 0;

class Complex {
    constructor(real,imag = 0) {
        this.real = real;
        this.imag = imag;
    }
    add(complex) {
        return new Complex(this.real + complex.real,this.imag + complex.imag)
    }
    sub(complex) {
        return new Complex(this.real - complex.real,this.imag - complex.imag)
    }
    mul(complex) {
        return new Complex(this.real * complex.real - this.imag * complex.imag,this.imag * complex.real + this.real * complex.imag)
    }
}

const PATH_DATA = [
    new Complex(23.7,87.9),new Complex(23.469086512656087,87.68325796596275),new Complex(23.24843584570639,87.46306696937555),new Complex(23.038004721844054,87.23953187448187),new Complex(22.837749863762248,87.01275754552525),
    new Complex(22.647627994154124,86.78284884674916),new Complex(22.467595835712842,86.54991064239714),new Complex(22.297610111131554,86.31404779671266),new Complex(22.137627543103427,86.07536517393923),
    new Complex(21.987604854321606,85.83396763832037),new Complex(21.84749876747926,85.58996005409956),new Complex(21.717266005269536,85.34344728552034),new Complex(21.5968632903856,85.09453419682617),
    new Complex(21.486247345520603,84.84332565226059),new Complex(21.385374893367707,84.58992651606707),new Complex(21.29420265662007,84.33444165248913),new Complex(21.212687357970843,84.07697592577028),
    new Complex(21.14078572011319,83.81763420015403),new Complex(21.07845446574026,83.55652133988386),new Complex(21.02565031754522,83.29374220920327),new Complex(20.982329998221225,83.02940167235579),
    new Complex(20.948450230461432,82.7636045935849),new Complex(20.923967736958993,82.49645583713412),new Complex(20.90883924040707,82.22806026724695),new Complex(20.90302146349882,81.95852274816689),
    new Complex(20.9064711289274,81.68794814413742),new Complex(20.91914495938597,81.4164413194021),new Complex(20.94099967756768,81.14410713820438),new Complex(20.9719920061657,80.87105046478779),
    new Complex(21.012078667873173,80.59737616339582),new Complex(21.061216385383265,80.32318909827198),new Complex(21.11936188138913,80.04859413365978),new Complex(21.186471878583927,79.7736961338027),
    new Complex(21.262503099660815,79.49859996294427),new Complex(21.347412267312947,79.22341048532799),new Complex(21.441156104233485,78.94823256519734),new Complex(21.543691333115582,78.67317106679586),
    new Complex(21.654974676652397,78.39833085436703),new Complex(21.77496285753709,78.12381679215434),new Complex(21.903612598462814,77.84973374440132),new Complex(22.04088062212273,77.57618657535147),
    new Complex(22.186723651209995,77.30328014924828),new Complex(22.341098408417764,77.03111933033526),new Complex(22.503961616439195,76.7598089828559),new Complex(22.675269997967447,76.48945397105373),
    new Complex(22.854980275695677,76.22015915917224),new Complex(23.043049172317037,75.95202941145493),new Complex(23.239433410524693,75.6851695921453),new Complex(23.4440897130118,75.41968456548686),
    new Complex(23.65697480247151,75.15567919572312),new Complex(23.878045401596985,74.89325834709757),new Complex(24.107258233081385,74.63252688385373),new Complex(24.34457001961786,74.37358967023508),
    new Complex(24.589937483899572,74.11655157048514),new Complex(24.843317348619678,73.86151744884741),new Complex(25.104666336471332,73.6085921695654),new Complex(25.3739411701477,73.3578805968826),
    new Complex(25.651098572341926,73.10948759504251),new Complex(25.93609526574718,72.86351802828865),new Complex(26.228887973056615,72.62007676086452),new Complex(26.529433416963386,72.37926865701363),
    new Complex(26.837688320160655,72.14119858097945),new Complex(27.153609405341573,71.90597139700552),new Complex(27.4771533951993,71.67369196933532),new Complex(27.808277012426995,71.44446516221237),
    new Complex(28.146936979717815,71.21839583988016),new Complex(28.49309001976492,70.99558886658221),new Complex(28.846692855261455,70.776149106562),new Complex(29.207702208900596,70.56018142406305),
    new Complex(29.576074803375487,70.34779068332887),new Complex(29.951767361379293,70.13908174860293),new Complex(30.334736605605162,69.93415948412877),new Complex(30.653102457363204,69.7784861796273),
    new Complex(30.953175539178556,69.63711385772244),new Complex(31.249018017821687,69.5009556999087),new Complex(31.541166933058182,69.37001170618609),new Complex(31.830159324653625,69.24428187655461),
    new Complex(32.116532232373594,69.12376621101426),new Complex(32.40082269598367,69.00846470956503),new Complex(32.68356775524944,68.89837737220694),new Complex(32.96530444993649,68.79350419893997),
    new Complex(33.24656981981039,68.69384518976413),new Complex(33.527900904636724,68.59940034467942),new Complex(33.80983474418109,68.51016966368584),new Complex(34.092908378209046,68.42615314678339),
    new Complex(34.37765884648619,68.34735079397205),new Complex(34.66462318877811,68.27376260525186),new Complex(34.954338444850364,68.2053885806228),new Complex(35.247341654468556,68.14222872008486),
    new Complex(35.544169857398266,68.08428302363804),new Complex(35.84536009340506,68.03155149128236),new Complex(36.15144940225454,67.9840341230178),new Complex(36.46297482371228,67.94173091884437),
    new Complex(36.78047339754386,67.90464187876208),new Complex(37.10448216351485,67.8727670027709),new Complex(37.43553816139086,67.84610629087086),new Complex(37.774178430937454,67.82465974306194),
    new Complex(38.12094001192022,67.80842735934417),new Complex(38.47635994410473,67.7974091397175),new Complex(38.84097526725658,67.79160508418198),new Complex(39.215323021141344,67.79101519273758),
    new Complex(39.59994024552461,67.79563946538431),new Complex(40.01389799660046,67.8116203368129),new Complex(40.452648459961104,67.85328341865558),new Complex(40.892047692875735,67.91644686009926),
    new Complex(41.328474402430935,67.99795663183224),new Complex(41.75830729571327,68.09465870454281),new Complex(42.17792507980932,68.2033990489193),new Complex(42.58370646180565,68.32102363565),
    new Complex(42.972030148788825,68.4443784354232),new Complex(43.33927484784543,68.57030941892722),new Complex(43.68181926606202,68.69566255685037),new Complex(43.99604211052518,68.81728381988093),
    new Complex(44.278322088321474,68.93201917870724),new Complex(44.52503790653748,69.03671460401756),new Complex(44.732568272259755,69.12821606650023),new Complex(44.89729189257488,69.20336953684354),
    new Complex(45.01558747456942,69.25902098573579),new Complex(45.08383372532996,69.29201638386529),new Complex(45.09999963667501,69.24016283351618),new Complex(45.09999012133093,68.98621737823954),
    new Complex(45.099967789920655,68.73020950534755),new Complex(45.099932762981254,68.47215940480183),new Complex(45.09988516104982,68.21208726656398),new Complex(45.099825104663424,67.95001328059567),
    new Complex(45.09975271435917,67.6859576368585),new Complex(45.09966811067412,67.4199405253141),new Complex(45.09957141414538,67.15198213592409),new Complex(45.09946274531003,66.8821026586501),
    new Complex(45.09934222470513,66.61032228345375),new Complex(45.0992099728678,66.33666120029669),new Complex(45.0990661103351,66.06113959914052),new Complex(45.09891075764413,65.78377766994687),
    new Complex(45.098744035331954,65.50459560267737),new Complex(45.09856606393567,65.22361358729366),new Complex(45.09837696399237,64.94085181375733),new Complex(45.098176856039125,64.65633047203004),
    new Complex(45.09796586061302,64.3700697520734),new Complex(45.09774409825115,64.08208984384905),new Complex(45.09751168949059,63.79241093731859),new Complex(45.097268754868416,63.50105322244367),
    new Complex(45.097015414921735,63.20803688918591),new Complex(45.09675179018762,62.913382127506935),new Complex(45.096478001203145,62.617109127368366),new Complex(45.096194168505406,62.31923807873183),
    new Complex(45.095900412631494,62.019789171558955),new Complex(45.095596854118476,61.71878259581136),new Complex(45.09528361350345,61.41623854145069),new Complex(45.09496081132349,61.112177198438545),
    new Complex(45.09462856811569,60.806618756736576),new Complex(45.094287004417126,60.49958340630639),new Complex(45.09393624076489,60.191091337109626),new Complex(45.09357639769606,59.8811627391079),
    new Complex(45.09320759574772,59.56981780226285),new Complex(45.09282995545696,59.257076716536076),new Complex(45.09244359736087,58.942959671889234),new Complex(45.09204864199651,58.62748685828394),
    new Complex(45.091645209900996,58.310678465681804),new Complex(45.091233421611385,57.99255468404448),new Complex(45.09081339766478,57.67313570333357),new Complex(45.09038525859825,57.352441713510714),
    new Complex(45.0899491249489,57.030492904537525),new Complex(45.08950511725379,56.70730946637565),new Complex(45.08905335605002,56.38291158898669),new Complex(45.08859396187468,56.05731946233229),
    new Complex(45.088127055264835,55.73055327637406),new Complex(45.08765275675758,55.40263322107364),new Complex(45.08717118689,55.073579486392646),new Complex(45.08668246619918,54.743412262292715),
    new Complex(45.0861867152222,54.41215173873546),new Complex(45.08568405449614,54.07981810568251),new Complex(45.0851746045581,53.746431553095505),new Complex(45.08465848594515,53.412012270936046),
    new Complex(45.08413581919438,53.076580449165775),new Complex(45.08360672484287,52.74015627774632),new Complex(45.08307132342772,52.4027599466393),new Complex(45.082529735486,52.064411645806345),
    new Complex(45.08198208155479,51.72513156520908),new Complex(45.081428482171184,51.38493989480912),new Complex(45.08086905787226,51.04385682456811),new Complex(45.08030392919511,50.70190254444767),
    new Complex(45.07973321667682,50.35909724440941),new Complex(45.07915704085446,50.01546111441498),new Complex(45.078575522265126,49.67101434442599),new Complex(45.077988781445896,49.32577712440407),
    new Complex(45.077396938933866,48.97976964431085),new Complex(45.0768001152661,48.63301209410794),new Complex(45.0761984309797,48.28552466375699),new Complex(45.07559200661175,47.9373275432196),
    new Complex(45.07498096269932,47.588440922457416),new Complex(45.07436541977951,47.23888499143206),new Complex(45.07374549838939,46.88867994010515),new Complex(45.07312131906606,46.537845958438325),
    new Complex(45.0724930023466,46.1864032363932),new Complex(45.071860668768075,45.8343719639314),new Complex(45.071224438867596,45.481772331014554),new Complex(45.07058443318223,45.128624527604295),
    new Complex(45.069940772249076,44.774948743662236),new Complex(45.069293576605205,44.42076516915),new Complex(45.068642966787706,44.066093994029245),new Complex(45.06798906333366,43.71095540826156),
    new Complex(45.06733198678016,43.35536960180859),new Complex(45.06667185766428,42.99935676463195),new Complex(45.066008796523114,42.64293708669328),new Complex(45.065342923893745,42.28613075795418),
    new Complex(45.06467436031325,41.92895796837631),new Complex(45.06400322631872,41.57143890792128),new Complex(45.063329642447236,41.21359376655071),new Complex(45.062653729235876,40.85544273422623),
    new Complex(45.06197560722174,40.497006000909465),new Complex(45.0612953969419,40.13830375656204),new Complex(45.06061321893345,39.779356191145595),new Complex(45.05992919373347,39.42018349462174),
    new Complex(45.05924344187903,39.0608058569521),new Complex(45.058556083907234,38.70124346809831),new Complex(45.057867240355165,38.34151651802199),new Complex(45.05717703175989,37.98164519668477),
    new Complex(45.05648557865852,37.62164969404828),new Complex(45.055793001588114,37.26155020007413),new Complex(45.05509942108577,36.901366904723965),new Complex(45.05440495768857,36.54111999795939),
    new Complex(45.053709731933594,36.18082966974205),new Complex(45.053013864357936,35.820516110033566),new Complex(45.05231747549867,35.460199508795554),new Complex(45.051620685892885,35.09990005598965),
    new Complex(45.05092361607766,34.739637941577485),new Complex(45.05022638659009,34.37943335552066),new Complex(45.04952911796725,34.01930648778083),new Complex(45.04883193074624,33.659277528319606),
    new Complex(45.04813494546412,33.29936666709862),new Complex(45.04743828265799,32.93959409407948),new Complex(45.04674206286493,32.57997999922384),new Complex(45.046046406622025,32.22054457249332),
    new Complex(45.04535143446636,31.86130800384951),new Complex(45.04465726693502,31.502290483254086),new Complex(45.043964024565085,31.14351220066864),new Complex(45.04327182789365,30.78499334605482),
    new Complex(45.04258079745779,30.426754109374222),new Complex(45.041891053794586,30.068814680588517),new Complex(45.04120271744113,29.71119524965929),new Complex(45.0405159089345,29.35391600654819),
    new Complex(45.03983074881179,28.99699714121683),new Complex(45.03914735761008,28.640458843626845),new Complex(45.03846585586645,28.28432130373985),new Complex(45.037786364117984,27.92860471151748),
    new Complex(45.03710900290177,27.57332925692136),new Complex(45.03643389275489,27.218515129913108),new Complex(45.03576115421444,26.864182520454364),new Complex(45.03509090781749,26.510351618506746),
    new Complex(45.03442327410113,26.157042614031873),new Complex(45.03375837360244,25.804275696991397),new Complex(45.033096326858505,25.452071057346906),new Complex(45.03243725440642,25.100448885060047),
    new Complex(45.031781276783256,24.749429370092457),new Complex(45.0311285145261,24.399032702405727),new Complex(45.030479088172044,24.04927907196152),new Complex(45.02983311825817,23.700188668721438),
    new Complex(45.02919072532155,23.351781682647122),new Complex(45.02855202989928,23.004078303700176),new Complex(45.027917152528445,22.657098721842253),new Complex(45.02728621374613,22.310863127034956),
    new Complex(45.026659334089416,21.96539170923993),new Complex(45.026036634095384,21.620704658418788),new Complex(45.02541823430112,21.276822164533172),new Complex(45.02480425524371,20.93376441754468),
    new Complex(45.02419481746024,20.591551607414978),new Complex(45.02359004148779,20.25020392410564),new Complex(45.02299004786345,19.909741557578336),new Complex(45.022394957124305,19.570184697794673),
    new Complex(45.02180488980743,19.231553534716276),new Complex(45.02121996644991,18.89386825830477),new Complex(45.02064030758885,18.557149058521794),new Complex(45.0200660337613,18.221416125328957),
    new Complex(45.01949726550438,17.886689648687906),new Complex(45.018934123355145,17.552989818560242),new Complex(45.01837672785069,17.220336824907612),new Complex(45.01782519952811,16.88875085769162),
    new Complex(45.01727965892448,16.558252106873915),new Complex(45.01674022657688,16.228860762416105),new Complex(45.0162070230224,15.900597014279825),new Complex(45.01568016879813,15.573481052426708),
    new Complex(45.01515978444114,15.247533066818363),new Complex(45.01464599048852,14.922773247416423),new Complex(45.01413890747736,14.599221784182518),new Complex(45.01363865594474,14.276898867078266),
    new Complex(45.01314535642774,13.955824686065313),new Complex(45.01265912946346,13.636019431105254),new Complex(45.01218009558897,13.317503292159735),new Complex(45.01170837534135,13.000296459190373),
    new Complex(45.0112440892577,12.684419122158808),new Complex(45.010787357875095,12.36989147102664),new Complex(45.01033830173062,12.056733695755518),new Complex(45.009897041361356,11.744965986307058),
    new Complex(45.0094636973044,11.434608532642905),new Complex(45.009038390096826,11.125681524724648),new Complex(45.008621240275716,10.818205152513947),new Complex(45.00821236837816,10.512199605972398),
    new Complex(45.00781189494124,10.207685075061661),new Complex(45.00741994050205,9.90468174974334),new Complex(45.00703662559766,9.60320981997905),new Complex(45.00666207076515,9.303289475730438),
    new Complex(45.00629639654163,9.004940906959149),new Complex(45.00593972346416,8.708184303626759),new Complex(45.00559217206983,8.413039855694912),new Complex(45.005253862895735,8.119527753125254),
    new Complex(45.00492491647895,7.827668185879389),new Complex(45.004605453356554,7.537481343918948),new Complex(45.004295594065646,7.248987417205576),new Complex(45.0039954591433,6.962206595700863),
    new Complex(45.003705169126604,6.677159069366475),new Complex(45.00342484455264,6.393865028164008),new Complex(45.00315460595849,6.112344662055094),new Complex(45.00289457388125,5.8326181610013705),
    new Complex(45.00264486885799,5.554705714964442),new Complex(45.0024056114258,5.27862751390596),new Complex(45.00217692212177,5.004403747787535),new Complex(45.001958921482974,4.732054606570799),
    new Complex(45.00175173004651,4.461600280217368),new Complex(45.001555468349444,4.193060958688875),new Complex(45.00137025692887,3.926456831946936),new Complex(45.00119621632188,3.6618080899531975),
    new Complex(45.001033467065554,3.399134922669276),new Complex(45.00088212969696,3.1384575200567895),new Complex(45.000742324753205,2.8797960720773688),new Complex(45.000614172771364,2.6231707686926597),
    new Complex(45.00049779428852,2.368601799864237),new Complex(45.000393309841755,2.1161093555537747),new Complex(45.00030083996816,1.86571362572289),new Complex(45.000220505204815,1.6174348003331858),
    new Complex(45.00015242608881,1.371293069346308),new Complex(45.00009672315722,1.127308622723902),new Complex(45.00005351694713,0.8855016504275426),new Complex(45.00002292799564,0.6458923424188896),
    new Complex(45.00000507683982,0.40850088865956025),new Complex(45.0352354562243,0.19995865253402026),new Complex(45.33556679764368,0.19631620227802396),new Complex(45.62401792360574,0.18772435610664975),
    new Complex(45.907250508330165,0.17551544886383388),new Complex(46.191926226036635,0.16102181539351268),new Complex(46.48470675094484,0.1455757905396224),new Complex(46.792253757274445,0.13050970914609936),
    new Complex(47.12122891924514,0.11715590605687981),new Complex(47.478293911076605,0.10684671611590005),new Complex(47.87011040698853,0.10091447416709638),new Complex(48.1,0.267326435401476),
    new Complex(48.1,0.6215659418109268),new Complex(48.1,0.9607857182482841),new Complex(48.1,1.2872485133768974),new Complex(48.1,1.6032170758601159),new Complex(48.1,1.9109541543612896),new Complex(48.1,2.2127224975437674),
    new Complex(48.1,2.5107848540708995),new Complex(48.10001953195266,2.852713499542245),new Complex(48.101039176586276,3.2372479980733915),new Complex(48.10541909671175,3.5769898717874447),
    new Complex(48.11562613825345,3.884273350306282),new Complex(48.13412714713576,4.17143266325178),new Complex(48.16338896928304,4.450802040245815),new Complex(48.20597470913887,4.737565398952217),
    new Complex(48.25616938359429,5.047173771624907),new Complex(48.30718351477918,5.350787298342027),new Complex(48.35915940976036,5.648652279796137),new Complex(48.412239375604635,5.941015016679791),
    new Complex(48.46656571937881,6.228121809685549),new Complex(48.52228074814971,6.510218959505965),new Complex(48.57952676898413,6.787552766833599),new Complex(48.63844608894889,7.0603695323610065),
    new Complex(48.6991810151108,7.328915556780745),new Complex(48.761873854536674,7.5934371407853725),new Complex(48.82666691429331,7.854180585067445),new Complex(48.893702501447535,8.11139219031952),
    new Complex(48.96312292306615,8.365318257234154),new Complex(49.03507048621597,8.616205086503905),new Complex(49.1096874979638,8.864298978821331),new Complex(49.18711626537646,9.109846234878987),
    new Complex(49.26749909552075,9.353093155369432),new Complex(49.350978295463484,9.594286040985224),new Complex(49.43769617227148,9.833671192418915),new Complex(49.52779503301154,10.07149491036307),
    new Complex(49.621417184750484,10.308003495510238),new Complex(49.71870493455512,10.543443248552983),new Complex(49.819800589492246,10.778060470183856),new Complex(49.92484645662869,11.012101461095419),
    new Complex(50.033984843031256,11.245812521980227),new Complex(50.14735805576675,11.47943995353084),new Complex(50.26510840190199,11.713230056439809),new Complex(50.38737818850379,11.947429131399698),
    new Complex(50.51430972263895,12.182283479103058),new Complex(50.64604531137428,12.41803940024245),new Complex(50.78272726177661,12.654943195510432),new Complex(50.924497880912725,12.893241165599559),
    new Complex(51.07149947584945,13.133179611202387),new Complex(51.2238743536536,13.375004833011474),new Complex(51.381764821391975,13.61896313171938),new Complex(51.545313186131395,13.86530080801866),
    new Complex(51.71466175493866,14.11426416260187),new Complex(51.88995283488059,14.36609949616157),new Complex(52.071328733024,14.621053109390314),new Complex(52.25893175643568,14.879371302980658),
    new Complex(52.45290421218246,15.141300377625164),new Complex(52.65338840733115,15.407086634016387),new Complex(52.86052664894855,15.676976372846887),new Complex(53.07446124410148,15.951215894809213),
    new Complex(53.29533449985675,16.23005150059593),new Complex(53.52328872328117,16.513729490899593),new Complex(53.75846622144154,16.80249616641276),new Complex(54.001009301404686,17.096597827827985),
    new Complex(54.25106027023741,17.396280775837823),new Complex(54.50876143500653,17.701791311134837),new Complex(54.77425510277885,18.013375734411586),new Complex(55.04768358062118,18.331280346360618),
    new Complex(55.32918917560035,18.6557514476745),new Complex(55.61891419478314,18.987035339045782),new Complex(55.917000945236374,19.325378321167026),new Complex(56.22359173402687,19.671026694730784),
    new Complex(56.53882886822143,20.024226760429617),new Complex(56.862854654886874,20.385224818956083),new Complex(57.19581140109,20.754267171002734),new Complex(57.53784141389763,21.131600117262135),
    new Complex(57.8585565960716,21.488467617556918),new Complex(58.16862480050398,21.836754663665662),new Complex(58.473429842365825,22.18176682760591),new Complex(58.773008901930744,22.523564401713255),
    new Complex(59.06739915947236,22.862207678323298),new Complex(59.35663779526429,23.197756949771627),new Complex(59.64076198958014,23.530272508393843),new Complex(59.91980892269355,23.859814646525535),
    new Complex(60.19381577487811,24.186443656502302),new Complex(60.46281972640745,24.510219830659736),new Complex(60.7268579575552,24.83120346133343),new Complex(60.985967648594944,25.149454840858986),
    new Complex(61.24018597980032,25.46503426157199),new Complex(61.48955013144495,25.778002015808042),new Complex(61.734097283802434,26.088418395902735),new Complex(61.973864617146404,26.39634369419166),
    new Complex(62.20888931175046,26.701838203010418),new Complex(62.439208547888235,27.0049622146946),new Complex(62.66485950583334,27.305776021579803),new Complex(62.88587936585939,27.604339916001617),
    new Complex(63.10230530824,27.900714190295645),new Complex(63.31417451324879,28.194959136797472),new Complex(63.52152416115938,28.4871350478427),new Complex(63.72439143224537,28.777302215766916),
    new Complex(63.9228135067804,29.065520932905724),new Complex(64.11682756503807,29.351851491594708),new Complex(64.306470787292,29.636354184169477),new Complex(64.49178035381581,29.91908930296561),
    new Complex(64.67279344488313,30.20011714031871),new Complex(64.84954724076755,30.479497988564376),new Complex(65.0220789217427,30.757292140038192),new Complex(65.1904256680822,31.03355988707576),
    new Complex(65.35462466005966,31.30836152201267),new Complex(65.5147130779487,31.58175733718452),new Complex(65.67072810202293,31.853807624926905),new Complex(65.82270691255599,32.124572677575415),
    new Complex(65.97068668982146,32.39411278746565),new Complex(66.11470461409299,32.66248824693321),new Complex(66.25479786564418,32.929759348313674),new Complex(66.39100362474865,33.19598638394264),
    new Complex(66.52335907168,33.461229646155715),new Complex(66.65190138671188,33.725549427288485),new Complex(66.7766677501179,33.98900601967655),new Complex(66.89769534217164,34.25165971565549),
    new Complex(67.01502134314676,34.513570807560924),new Complex(67.12868293331685,34.774799587728424),new Complex(67.23871729295554,35.035406348493595),new Complex(67.34516160233645,35.29545138219203),
    new Complex(67.44805304173317,35.55499498115932),new Complex(67.54742879141936,35.814097437731064),new Complex(67.64332603166861,36.07281904424286),new Complex(67.73578194275453,36.331220093030296),
    new Complex(67.82483370495075,36.58936087642897),new Complex(67.91051849853088,36.84730168677448),new Complex(67.99287350376855,37.10510281640241),new Complex(68.07193590093735,37.362824557648366),
    new Complex(68.14774287031092,37.62052720284794),new Complex(68.22033159216288,37.878271044336714),new Complex(68.28973924676683,38.136116374450296),new Complex(68.35600301439639,38.39412348552428),
    new Complex(68.41916007532518,38.65235266989426),new Complex(68.47924760982683,38.91086421989583),new Complex(68.53630279817493,39.16971842786458),new Complex(68.59036282064312,39.42897558613611),
    new Complex(68.641464857505,39.68869598704602),new Complex(68.68964608903418,39.94893992292988),new Complex(68.73494369550431,40.209767686123314),new Complex(68.77739485718898,40.471239568961906),
    new Complex(68.81703675436182,40.73341586378125),new Complex(68.85390656729643,40.99635686291693),new Complex(68.88804147626645,41.26012285870456),new Complex(68.91947866154548,41.52477414347972),
    new Complex(68.94825530340714,41.79037100957802),new Complex(68.97440858212504,42.05697374933503),new Complex(68.9979756779728,42.324642655086365),new Complex(69.01899377122406,42.59343801916762),
    new Complex(69.0375000421524,42.863420133914374),new Complex(69.05353167103146,43.13464929166224),new Complex(69.06712583813486,43.4071857847468),new Complex(69.07831972373619,43.681089905503654),
    new Complex(69.08715050810909,43.95642194626839),new Complex(69.09365537152718,44.233242199376605),new Complex(69.09787149426406,44.511610957163896),new Complex(69.09983605659335,44.79158851196587),
    new Complex(69.09632473563597,45.08115055397005),new Complex(69.08506719315795,45.3828524912574),new Complex(69.0674112688437,45.69273793035273),new Complex(69.04351429473397,46.01046758128985),
    new Complex(69.01353360286951,46.335702154102606),new Complex(68.97762652529113,46.66810235882482),new Complex(68.93595039403955,47.00732890549032),new Complex(68.88866254115555,47.35304250413292),
    new Complex(68.83592029867991,47.70490386478647),new Complex(68.77788099865337,48.06257369748479),new Complex(68.71470197311672,48.4257127122617),new Complex(68.6465405541107,48.79398161915103),
    new Complex(68.5735540736761,49.167041128186625),new Complex(68.49589986385368,49.54455194940229),new Complex(68.41373525668419,49.92617479283186),new Complex(68.32721758420841,50.31157036850917),
    new Complex(68.2365041784671,50.70039938646804),new Complex(68.14175237150103,51.09232255674231),new Complex(68.04311949535095,51.48700058936579),new Complex(67.94076288205764,51.884094194372324),
    new Complex(67.83483986366187,52.28326408179572),new Complex(67.72550777220438,52.684170961669835),new Complex(67.61292393972597,53.086475544028474),new Complex(67.49724569826738,53.48983853890547),
    new Complex(67.37863037986938,53.89392065633466),new Complex(67.25723531657275,54.298382606349854),new Complex(67.13321784041823,54.70288509898489),new Complex(67.0067352834466,55.107088844273605),
    new Complex(66.87794497769862,55.51065455224982),new Complex(66.74700425521507,55.913242932947355),new Complex(66.6140704480367,56.31451469640004),new Complex(66.47930088820428,56.71413055264171),
    new Complex(66.34285290775857,57.1117512117062),new Complex(66.20488383874034,57.50703738362732),new Complex(66.06555101319037,57.899649778438906),new Complex(65.9250117631494,58.289249106174786),
    new Complex(65.78342342065821,58.67549607686879),new Complex(65.64094331775755,59.05805140055474),new Complex(65.49772878648821,59.43657578726647),new Complex(65.35393715889093,59.8107299470378),
    new Complex(65.2097257670065,60.18017458990257),new Complex(65.06525194287566,60.5445704258946),new Complex(64.9206730185392,60.90357816504772),new Complex(64.77614632603786,61.256858517395756),
    new Complex(64.63182919741243,61.60407219297254),new Complex(64.48787896470365,61.94487990181189),new Complex(64.34445295995232,62.27894235394764),new Complex(64.20170851519917,62.60592025941362),
    new Complex(64.05980296248498,62.925474328243666),new Complex(63.918893633850516,63.23726527047159),new Complex(63.779137861336544,63.54095379613123),new Complex(63.64069297698382,63.8362006152564),
    new Complex(63.50371631283313,64.12266643788095),new Complex(63.36836520092521,64.40001197403869),new Complex(63.23479697330085,64.66789793376346),new Complex(63.10316896200081,64.92598502708908),
    new Complex(62.97363849906584,65.17393396404938),new Complex(62.84636291653673,65.41140545467819),new Complex(62.72149954645422,65.63806020900932),new Complex(62.599205720859096,65.85355893707663),
    new Complex(62.47963877179211,66.05756234891393),new Complex(62.36295603129403,66.24973115455505),new Complex(62.249314831405634,66.42972606403382),new Complex(62.138872504167665,66.59720778738406),
    new Complex(62.031786381620904,66.7518370346396),new Complex(61.928213795806116,66.89327451583428),new Complex(61.82831207876406,67.02118094100192),new Complex(61.7322385625355,67.13521702017634),
    new Complex(61.64015057916121,67.23504346339138),new Complex(61.55220546068195,67.32032098068086),new Complex(61.46856053913848,67.3907102820786),new Complex(61.38937314657158,67.44587207761846),
    new Complex(61.314800615022,67.48546707733423),new Complex(61.24500027653051,67.50915599125977),new Complex(61.18012946313788,67.51659952942889),new Complex(61.12034550688487,67.50745840187541),
    new Complex(61.1705274180783,67.3032681729705),new Complex(61.282290075197274,66.99438498590517),new Complex(61.39549042368857,66.68477992471558),new Complex(61.51002124336524,66.37450475087131),
    new Complex(61.62577531404034,66.0636112258419),new Complex(61.74264541552694,65.75215111109691),new Complex(61.86052432763808,65.4401761681059),new Complex(61.979304830186834,65.12773815833843),
    new Complex(62.09887970298626,64.81488884326407),new Complex(62.219141725849404,64.50167998435236),new Complex(62.339983678589334,64.18816334307287),new Complex(62.461298341019116,63.874390680895154),
    new Complex(62.58297849295179,63.560413759288764),new Complex(62.704916914200425,63.24628433972326),new Complex(62.827006384578084,62.93205418366821),new Complex(62.94913968389781,62.61777505259316),
    new Complex(63.07120959197268,62.30349870796768),new Complex(63.19310888861574,61.98927691126131),new Complex(63.31473035364006,61.67516142394362),new Complex(63.43596676685868,61.361204007484176),
    new Complex(63.55671090808467,61.04745642335252),new Complex(63.67685555713109,60.733970433018214),new Complex(63.796293493811,60.420797797950826),new Complex(63.914917497937445,60.107990279619905),
    new Complex(64.0326203493235,59.79559963949501),new Complex(64.14929482778221,59.4836776390457),new Complex(64.26483371312665,59.17227603974153),new Complex(64.37912978516985,58.861446603052066),
    new Complex(64.4920758237249,58.55124109044686),new Complex(64.60356460860484,58.24171126339547),new Complex(64.71348891962273,57.93290888336745),new Complex(64.82174153659165,57.62488571183237),
    new Complex(64.92821523932462,57.31769351025978),new Complex(65.03280280763472,57.01138404011923),new Complex(65.13539702133502,56.7060090628803),new Complex(65.23589066023855,56.40162034001253),
    new Complex(65.33417650415839,56.09826963298548),new Complex(65.43014733290761,55.79600870326871),new Complex(65.52369592629923,55.49488931233178),new Complex(65.61471506414634,55.194963221644244),
    new Complex(65.70309752626197,54.89628219267567),new Complex(65.7887360924592,54.5988979868956),new Complex(65.8715235425511,54.302862365773606),new Complex(65.9513526563507,54.00822709077924),
    new Complex(66.02811621367108,53.71504392338206),new Complex(66.10170699432528,53.423364625051626),new Complex(66.17201777812639,53.1332409572575),new Complex(66.23894134488742,52.84472468146922),
    new Complex(66.30237047442147,52.55786755915637),new Complex(66.36219794654158,52.2727213517885),new Complex(66.4183165410608,51.98933782083516),new Complex(66.47061903779222,51.70776872776591),
    new Complex(66.51899821654887,51.428065834050315),new Complex(66.56334685714381,51.15028090115793),new Complex(66.60390362327432,50.87338020862557),new Complex(66.64320937907257,50.58481167859734),
    new Complex(66.6775655095899,50.292734529207394),new Complex(66.70701572424825,49.99730059318465),new Complex(66.73160373246961,49.698661703258026),new Complex(66.75137324367591,49.396969692156425),
    new Complex(66.76636796728913,49.09237639260878),new Complex(66.77663161273124,48.78503363734399),new Complex(66.78220788942417,48.47509325909099),new Complex(66.7831405067899,48.16270709057868),
    new Complex(66.7794731742504,47.84802696453598),new Complex(66.77124960122761,47.531204713691814),new Complex(66.7585134971435,47.21239217077508),new Complex(66.74130857142003,46.89174116851471),
    new Complex(66.71967853347917,46.569403539639616),new Complex(66.69366709274287,46.24553111687871),new Complex(66.66331795863309,45.9202757329609),new Complex(66.62867484057179,45.59378922061512),
    new Complex(66.58978144798093,45.266223412570284),new Complex(66.54668149028248,44.93773014155529),new Complex(66.49941867689839,44.608461240299064),new Complex(66.44803671725063,44.27856854153053),
    new Complex(66.39257932076114,43.94820387797859),new Complex(66.33309019685191,43.61751908237217),new Complex(66.2696130549449,43.28666598744017),new Complex(66.20219160446203,42.95579642591153),
    new Complex(66.13086955482531,42.62506223051515),new Complex(66.05569061545667,42.29461523397995),new Complex(65.97669849577808,41.964607269034836),new Complex(65.89393690521149,41.63519016840874),
    new Complex(65.80744955317888,41.306515764830564),new Complex(65.71728014910221,40.97873589102923),new Complex(65.62347240240342,40.65200237973366),new Complex(65.52607002250448,40.32646706367276),
    new Complex(65.42511671882735,40.00228177557545),new Complex(65.320656200794,39.679598348170636),new Complex(65.2127321778264,39.35856861418725),new Complex(65.10138835934647,39.0393444063542),
    new Complex(64.98666845477621,38.7220775574004),new Complex(64.86861617353756,38.40691990005477),new Complex(64.74727522505248,38.09402326704622),new Complex(64.62268931874294,37.78353949110367),
    new Complex(64.4949021640309,37.475620404956025),new Complex(64.36395747033832,37.170417841332224),new Complex(64.22989894708716,36.86808363296116),new Complex(64.09277030369937,36.568769612571764),
    new Complex(63.95261524959693,36.27262761289295),new Complex(63.809477494201786,35.97980946665362),new Complex(63.663400746935906,35.6904670065827),new Complex(63.51442871722124,35.404752065409106),
    new Complex(63.36260511447976,35.122816475861754),new Complex(63.20797364813343,34.84481207066956),new Complex(63.050578027604196,34.57089068256143),new Complex(62.89046196231403,34.30120414426629),
    new Complex(62.72766916168489,34.035904288513066),new Complex(62.56224333513873,33.77514294803065),new Complex(62.394228192097515,33.51907195554797),new Complex(62.22366744198321,33.26784314379394),
    new Complex(62.05060479421777,33.021608345497484),new Complex(61.87508395822316,32.7805193933875),new Complex(61.697148643421336,32.544728120192914),new Complex(61.51684255923426,32.31438635864265),
    new Complex(61.33420941508389,32.08964594146561),new Complex(61.1492929203922,31.870658701390717),new Complex(60.95826066938,31.650754681310573),new Complex(60.743828879857766,31.407064749764054),
    new Complex(60.51793857650972,31.16495674856725),new Complex(60.2811772652139,30.924596840998785),new Complex(60.03413245184831,30.686151190337295),new Complex(59.77739164229096,30.449785959861412),
    new Complex(59.51154234241987,30.215667312849764),new Complex(59.23717205811306,29.983961412580978),new Complex(58.95486829524853,29.754834422333687),new Complex(58.665218559704314,29.52845250538652),
    new Complex(58.368810357358406,29.304981825018114),new Complex(58.06623119408883,29.084588544507092),new Complex(57.7580685757736,28.867438827132087),new Complex(57.444910008290734,28.653698836171728),
    new Complex(57.12734299751824,28.443534734904645),new Complex(56.80595504933413,28.23711268660947),new Complex(56.48133366961643,28.034598854564837),new Complex(56.15406636424314,27.83615940204937),
    new Complex(55.82474063909229,27.6419604923417),new Complex(55.493944000041886,27.452168288720458),new Complex(55.16226395296994,27.266948954464276),new Complex(54.83028800375446,27.08646865285178),
    new Complex(54.49860365827348,26.91089354716161),new Complex(54.167798422405,26.74038980067239),new Complex(53.83845980202704,26.575123576662744),new Complex(53.51117530301761,26.415261038411312),
    new Complex(53.186532431254726,26.260968349196723),new Complex(52.865118692616406,26.112411672297604),new Complex(52.54752159298066,25.969757170992583),new Complex(52.2343286382255,25.8331710085603),
    new Complex(51.926127334228944,25.702819348279377),new Complex(51.62350518686901,25.578868353428444),new Complex(51.3270497020237,25.461484187286135),new Complex(51.03734838557105,25.35083301313108),
    new Complex(50.75498874338905,25.24708099424191),new Complex(50.480558281355734,25.15039429389725),new Complex(50.2146445053491,25.06093907537574),new Complex(49.957834921247176,24.978881501956),
    new Complex(49.71071703492797,24.904387736916664),new Complex(49.473878352269494,24.837623943536364),new Complex(49.24790637914977,24.778756285093735),new Complex(49.033388621446804,24.727950924867393),
    new Complex(48.83091258503862,24.685374026135985),new Complex(48.64106577580322,24.65119175217813),new Complex(48.464435699618626,24.62557026627246),new Complex(48.301609862362845,24.60867573169761),
    new Complex(48.15317576991391,24.600674311732206),new Complex(48.09999536545555,24.601687815419933),new Complex(48.099968181699026,24.611597092131916),new Complex(48.09991694018961,24.630298424395146),
    new Complex(48.099841955298224,24.65769907278563),new Complex(48.0997435413958,24.69370629787937),new Complex(48.09962201285328,24.73822736025237),new Complex(48.09947768404158,24.791169520480643),
    new Complex(48.099310869331624,24.85244003914019),new Complex(48.099121883094355,24.92194617680702),new Complex(48.09891103970069,24.999595194057132),new Complex(48.09867865352156,25.085294351466537),
    new Complex(48.0984250389279,25.17895090961124),new Complex(48.09815051029064,25.280472129067245),new Complex(48.09785538198069,25.38976527041056),new Complex(48.097539968369006,25.506737594217192),
    new Complex(48.097204583826496,25.631296361063143),new Complex(48.096849542724094,25.763348831524418),new Complex(48.096475159432735,25.902802266177027),new Complex(48.096081748323336,26.049563925596974),
    new Complex(48.09566962376684,26.203541070360263),new Complex(48.095239100134165,26.3646409610429),new Complex(48.09479049179625,26.532770858220893),new Complex(48.09432411312402,26.707838022470245),
    new Complex(48.09384027848839,26.889749714366964),new Complex(48.093339302260304,27.078413194487055),new Complex(48.09282149881069,27.273735723406524),new Complex(48.092287182510475,27.475624561701373),
    new Complex(48.09173666773058,27.683986969947615),new Complex(48.09117026884195,27.89873020872125),new Complex(48.090588300215494,28.119761538598283),new Complex(48.089991076222155,28.346988220154724),
    new Complex(48.08937891123286,28.58031751396658),new Complex(48.08875211961853,28.81965668060985),new Complex(48.08811101575011,29.064912980660544),new Complex(48.08745591399851,29.315993674694663),
    new Complex(48.08678712873467,29.572806023288223),new Complex(48.086104974329515,29.835257287017217),new Complex(48.085409765153976,30.10325472645766),new Complex(48.084701815578974,30.376705602185556),
    new Complex(48.08398143997545,30.655517174776907),new Complex(48.08324895271433,30.93959670480772),new Complex(48.08250466816653,31.228851452854006),new Complex(48.081748900703,31.523188679491764),
    new Complex(48.080981964694644,31.822515645297),new Complex(48.08020417451241,32.126739610845725),new Complex(48.079415844527226,32.435767836713936),new Complex(48.07861728911001,32.74950758347765),
    new Complex(48.077808822631695,33.06786611171287),new Complex(48.076990759463214,33.39075068199559),new Complex(48.0761634139755,33.71806855490183),new Complex(48.07532710053947,34.04972699100759),
    new Complex(48.074482133526054,34.38563325088887),new Complex(48.07362882730619,34.72569459512169),new Complex(48.07276749625079,35.06981828428204),new Complex(48.07189845473081,35.41791157894594),
    new Complex(48.07102201711715,35.76988173968938),new Complex(48.07013849778075,36.12563602708838),new Complex(48.06924821109255,36.48508170171894),new Complex(48.06835147142347,36.84812602415707),
    new Complex(48.067448593144434,37.214676254978755),new Complex(48.06653989062637,37.58463965476004),new Complex(48.06562567824022,37.957923484076886),new Complex(48.0647062703569,38.334435003505334),
    new Complex(48.06378198134734,38.71408147362138),new Complex(48.06285312558248,39.09677015500101),new Complex(48.06192001743324,39.48240830822026),new Complex(48.06098297127054,39.87090319385511),
    new Complex(48.06004230146533,40.26216207248159),new Complex(48.05909832238852,40.65609220467569),new Complex(48.058151348411045,41.05260085101341),new Complex(48.05720169390384,41.45159527207076),
    new Complex(48.05624967323782,41.852982728423754),new Complex(48.055295600783936,42.25667048064841),new Complex(48.05433979091309,42.662565789320695),new Complex(48.05338255799623,43.070575915016654),
    new Complex(48.05242421640428,43.48060811831226),new Complex(48.051465080508166,43.89256965978355),new Complex(48.05050546467882,44.3063678000065),new Complex(48.049545683287164,44.72190979955714),
    new Complex(48.04858605070414,45.139102919011464),new Complex(48.04762688130066,45.55785441894548),new Complex(48.04666848944767,45.97807155993519),new Complex(48.04571118951608,46.3996616025566),
    new Complex(48.04475529587684,46.822531807385715),new Complex(48.04380112290086,47.246589434998555),new Complex(48.04284898495908,47.67174174597111),new Complex(48.04189919642242,48.09789600087939),
    new Complex(48.04095207166182,48.5249594602994),new Complex(48.04000792504821,48.95283938480715),new Complex(48.0390670709525,49.381443034978645),new Complex(48.038129823745635,49.81067767138988),
    new Complex(48.03719649779854,50.24045055461687),new Complex(48.036267407482136,50.670668945235626),new Complex(48.035342867167365,51.101240103822136),new Complex(48.03442319122515,51.53207129095243),
    new Complex(48.03350869402642,51.9630697672025),new Complex(48.0325996899421,52.39414279314835),new Complex(48.031696493343134,52.82519762936599),new Complex(48.03079941860043,53.25614153643141),
    new Complex(48.029908780084924,53.68688177492065),new Complex(48.02902489216755,54.11732560540968),new Complex(48.02814806921923,54.54738028847453),new Complex(48.0272786256109,54.97695308469119),
    new Complex(48.02641687571348,55.40595125463567),new Complex(48.02556313389791,55.83428205888399),new Complex(48.02471771453511,56.26185275801214),new Complex(48.02388093199601,56.68857061259612),
    new Complex(48.02305310065154,57.114342883211954),new Complex(48.02223453487263,57.53907683043563),new Complex(48.021425549030205,57.96267971484318),new Complex(48.0206264574952,58.38505879701058),
    new Complex(48.019837574638544,58.80612133751385),new Complex(48.01905921483115,59.22577459692899),new Complex(48.01829169244397,59.643925835832015),new Complex(48.017535321847916,60.060482314798925),
    new Complex(48.01679041741393,60.47535129440572),new Complex(48.01605729351292,60.88844003522842),new Complex(48.01533626451584,61.299655797843016),new Complex(48.014627644793606,61.708905842825516),
    new Complex(48.01393174871714,62.116097430751935),new Complex(48.01324889065739,62.521137822198284),new Complex(48.01257938498526,62.92393427774054),new Complex(48.0119235460717,63.324394057954734),
    new Complex(48.01128168828763,63.72242442341687),new Complex(48.01065412600398,64.11793263470295),new Complex(48.010041173591674,64.51082595238897),new Complex(48.00944314542165,64.90101163705094),
    new Complex(48.00886035586483,65.28839694926486),new Complex(48.00829311929215,65.67288914960677),new Complex(48.00774175007452,66.05439549865264),new Complex(48.007206562582894,66.43282325697848),
    new Complex(48.00668787118819,66.80807968516032),new Complex(48.00618599026133,67.18007204377413),new Complex(48.00570123417325,67.54870759339595),new Complex(48.00523391729488,67.91389359460176),
    new Complex(48.004784353997145,68.27553730796757),new Complex(48.004352858650975,68.6335459940694),new Complex(48.0039397456273,68.98782691348323),new Complex(48.00354532929705,69.33828732678509),
    new Complex(48.00316992403115,69.68483449455098),new Complex(48.002813844200524,70.02737567735691),new Complex(48.00247740417612,70.36581813577888),new Complex(48.00216091832884,70.70006913039289),
    new Complex(48.00186470102963,71.03003592177495),new Complex(48.00158906664942,71.35562577050106),new Complex(48.001334329559135,71.67674593714725),new Complex(48.001100804129706,71.99330368228948),
    new Complex(48.00088880473205,72.3052062665038),new Complex(48.00069864573711,72.6123609503662),new Complex(48.00053064151581,72.91467499445268),new Complex(48.000385106439076,73.21205565933926),
    new Complex(48.00026235487784,73.50441020560191),new Complex(48.000162701203024,73.7916458938167),new Complex(48.00008645978557,74.07366998455959),new Complex(48.000033944996396,74.35038973840656),
    new Complex(48.000005471206435,74.62171241593367),new Complex(47.99903437260729,74.88650239720218),new Complex(47.984710274059516,75.15689657762421),new Complex(47.953980113700304,75.44054426355696),
    new Complex(47.907788733925216,75.7360281914071),new Complex(47.84708097712981,76.0419310975813),new Complex(47.772801685709645,76.35683571848621),new Complex(47.685895702060286,76.67932479052848),
    new Complex(47.5873078685773,77.00798105011476),new Complex(47.477983027656244,77.34138723365174),new Complex(47.35886602169268,77.67812607754605),new Complex(47.23090169308217,78.01678031820435),
    new Complex(47.09503488422027,78.3559326920333),new Complex(46.95221043750256,78.69416593543956),new Complex(46.80337319532458,79.03006278482978),new Complex(46.64946800008191,79.36220597661062),
    new Complex(46.4914396941701,79.68917824718875),new Complex(46.33023311998472,80.0095623329708),new Complex(46.16679311992132,80.32194097036346),new Complex(46.002064536375485,80.62489689577336),
    new Complex(45.83699221174275,80.91701284560716),new Complex(45.6725209884187,81.19687155627153),new Complex(45.50959570879888,81.46305576417312),new Complex(45.349161215278855,81.71414820571859),
    new Complex(45.19216235025419,81.94873161731459),new Complex(45.03954395612045,82.1653887353678),new Complex(44.89225087527319,82.36270229628484),new Complex(44.75122795010798,82.53925503647238),
    new Complex(44.55907213761814,82.76699969270746),new Complex(44.3286034683753,83.031418340381),new Complex(44.09264984211947,83.29176176289326),new Complex(43.85137814430547,83.54797433175933),
    new Complex(43.6049552603881,83.80000041849426),new Complex(43.353548075822175,84.04778439461313),new Complex(43.09732347606249,84.291270631631),new Complex(42.83644834656386,84.5304035010629),
    new Complex(42.5710895727811,84.76512737442395),new Complex(42.301414040169,84.99538662322918),new Complex(42.027588634182386,85.22112561899365),new Complex(41.74978024027605,85.44228873323244),
    new Complex(41.468155743904816,85.65882033746061),new Complex(41.18288203052349,85.87066480319321),new Complex(40.89412598558686,86.07776650194532),new Complex(40.602054494549755,86.28006980523202),
    new Complex(40.30683444286698,86.47751908456833),new Complex(40.00863271599333,86.67005871146935),new Complex(39.70761619938363,86.85763305745013),new Complex(39.403951778492676,87.04018649402573),
    new Complex(39.09780633877528,87.21766339271122),new Complex(38.78934676568625,87.39000812502167),new Complex(38.47873994468039,87.55716506247214),new Complex(38.166152761212516,87.71907857657769),
    new Complex(37.85175210073743,87.87569303885338),new Complex(37.53570484870994,88.02695282081429),new Complex(37.218177890584855,88.17280229397547),new Complex(36.89933811181699,88.31318582985197),
    new Complex(36.579352397861136,88.4480477999589),new Complex(36.25838763417212,88.57733257581128),new Complex(35.93661070620473,88.70098452892421),new Complex(35.61418849941379,88.81894803081272),
    new Complex(35.29128789925411,88.93116745299189),new Complex(34.96807579118048,89.03758716697678),new Complex(34.64471906064772,89.13815154428245),new Complex(34.321384593110636,89.23280495642399),
    new Complex(33.998239274024044,89.32149177491642),new Complex(33.675449988842736,89.40415637127485),new Complex(33.353183623021536,89.48074311701431),new Complex(33.03160706201523,89.55119638364988),
    new Complex(32.71088719127865,89.61546054269662),new Complex(32.39119089626659,89.6734799656696),new Complex(32.07268506243387,89.72519902408388),new Complex(31.755536575235283,89.77056208945451),
    new Complex(31.439912320125643,89.80951353329658),new Complex(31.12597918255976,89.84199772712513),new Complex(30.813904047992438,89.86795904245525),new Complex(30.503853801878495,89.88734185080197),
    new Complex(30.195995329672726,89.90009052368039),new Complex(29.890495516829944,89.90614943260555),new Complex(29.587521248804954,89.90546294909252),new Complex(29.28723941105257,89.89797544465637),
    new Complex(28.989816889027598,89.88363129081215),new Complex(28.69542056818484,89.86237485907493),new Complex(28.404217333979116,89.8341505209598),new Complex(28.11637407186522,89.79890264798178),
    new Complex(27.832057667297967,89.75657561165596),new Complex(27.551435005732166,89.7071137834974),new Complex(27.27467297262263,89.65046153502117),new Complex(27.00193845342415,89.58656323774231),
    new Complex(26.73339833359155,89.51536326317591),new Complex(26.46921949857963,89.43680598283703),new Complex(26.209568833843196,89.35083576824073),new Complex(25.954613224837065,89.25739699090207),
    new Complex(25.704519557016038,89.15643402233611),new Complex(25.459454715834926,89.04789123405793),new Complex(25.219585586748533,88.9317129975826),new Complex(24.98507905521167,88.80784368442515),
    new Complex(24.756102006679146,88.67622766610066),new Complex(24.532821326605767,88.53680931412421),new Complex(24.31540390044634,88.38953300001084),new Complex(24.104016613655677,88.23434309527563),
    new Complex(23.898826351688584,88.07118397143364)
]

function drawPoint(p,color) {
    ctx.beginPath();
    ctx.fillStyle = color;
    ctx.arc(p[0],p[1],1,0,Math.PI * 2);
    ctx.fill()
    ctx.closePath();
}

function drawHollowCircle(p,r) {
    ctx.beginPath();
    ctx.strokeStyle = CIRCLE_COLOR;
    ctx.lineWidth = 1;
    ctx.arc(p[0],p[1],r,0,Math.PI * 2);
    ctx.stroke()
    ctx.closePath();
}

function drawLine(p1,p2) {
    ctx.beginPath();
    ctx.moveTo(p1[0],p1[1]);
    ctx.strokeStyle = CIRCLE_COLOR;
    ctx.lineWidth = 1;
    ctx.lineTo(p2[0],p2[1]);
    ctx.stroke();
    ctx.closePath();
}

window.addEventListener('resize',event => {
    resetSim();
});

function toggleDrawPath() {
    drawpath = !drawpath;
    loopFinished = false;
}

function toggleDrawPoints() {
    drawpoints = !drawpoints;
    loopFinished = false;
}

function toggleDrawCircles() {
    drawcircles = !drawcircles;
    loopFinished = false;
}

function scaleChange() {
    let t = parseInt(document.getElementById("scale").value,10);

    if (t == "" || t < 1){
        document.getElementById("scale").value = 1;
    }
    else if (t > 6){
        document.getElementById("scale").value = 6;
    }
    complex_scale = parseInt(document.getElementById("scale").value,10);
    resetSim();
}

function circlesChange() {
    let t = parseInt(document.getElementById("circles").value,10);

    if (t == "" || t < 1){
        document.getElementById("circles").value = 1;
    }
    else if (t > 50){
        document.getElementById("circles").value = 50;
    }
    num_circles = parseInt(document.getElementById("circles").value,10);
    resetSim();
}

function resetSim() {
    canvas.width = canvasDiv.clientWidth;
    canvas.height = canvasDiv.clientHeight;
    width = canvasDiv.clientWidth;
    height = canvasDiv.clientHeight;

    origin = [Math.floor(width/2), Math.floor(height/2)];
    circles = [];
    points = [];
    lengths = [];
    output = [];
    loopFinished = false;
    t = 0;
    let l = 0;
    let realsum = 0;
    let imagsum = 0;
    for (let i = 0; i < NUM_SAMPLES; i++) {
        let p = PATH_DATA[i];
        realsum += p.real;
        imagsum += p.imag;
        let point = new Complex(p.real*complex_scale+origin[0], p.imag*complex_scale+origin[1]);
        points.push(point);
    }

    centeroffset = [realsum/NUM_SAMPLES*complex_scale, imagsum/NUM_SAMPLES*complex_scale];
    for (let i = 0; i < points.length; i++){
        points[i] = new Complex(points[i].real - centeroffset[0], points[i].imag - centeroffset[1]);
    }

    for (let n = -num_circles; n < num_circles+1; n++) {
        let cn = calculate_cn(n);
        circles.push(cn);
        if (n == 0) {
            lengths.push(0);
        }
        else {
            lengths.push(Math.sqrt(cn.real**2 + cn.imag**2));
        }
    }
}

function calculate_cn(n){
    let interval = 1/NUM_SAMPLES;
    let sum = new Complex(0, 0);
    for (let i = 0; i < NUM_SAMPLES; i++) {
        let angle = -n*2*Math.PI*i*interval;
        let exp = new Complex(Math.cos(angle), Math.sin(angle));
        sum = sum.add(points[i].mul(exp).mul(new Complex(interval)))
    }
    return sum
}

function draw() {
    if (!loopFinished) {
        let sum = new Complex(0);
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        if (drawpath) {
            points.forEach(point => {
                drawPoint([point.real, point.imag], PATH_COLOR)
            });
        }
        endpoint = circles[num_circles];
        sum = sum.add(endpoint);
        if (drawcircles) { 
            drawLine(origin, [endpoint.real, endpoint.imag]); 
        }
        for (let i = 1; i < num_circles+1; i++) {
            sum = sum.add(circles[num_circles+i].mul(new Complex(Math.cos(i*2*Math.PI*t), Math.sin(i*2*Math.PI*t)))).add(circles[num_circles-i].mul(new Complex(Math.cos(-i*2*Math.PI*t), Math.sin(-i*2*Math.PI*t))));
            temp = endpoint.add(circles[num_circles+i].mul(new Complex(Math.cos(i*2*Math.PI*t), Math.sin(i*2*Math.PI*t))));
            if (drawcircles) {
                drawLine([endpoint.real, endpoint.imag], [temp.real, temp.imag]);
                drawHollowCircle([endpoint.real, endpoint.imag], lengths[num_circles+i]);
            }
            endpoint = temp.add(circles[num_circles-i].mul(new Complex(Math.cos(-i*2*Math.PI*t), Math.sin(-i*2*Math.PI*t))));
            if (drawcircles) {
                drawLine([temp.real, temp.imag], [endpoint.real, endpoint.imag]);
                drawHollowCircle([temp.real, temp.imag], lengths[num_circles-i]);
            }
        }

        if (t >= 1) {
            loopFinished = true;
        }
        else {
            t += 0.001;
            output.push(sum);
            console.log("Added");
        }
        
        if (drawpoints) {
            output.forEach(point => {
                drawPoint([point.real, point.imag], POINTS_COLOR);
            });
        }
        
    }
}


function mainLoop(){
    draw()
    requestAnimationFrame(mainLoop)
}

resetSim();
mainLoop();